FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGdhbGVyYS1yZXBsaWNhdGlvbi1hcGIKZGVzY3JpcHRpb246IERl\
cGxveSBHYWxlcmEgd2l0aCBhIFJlcGxpY2F0aW9uIE9wZXJhdG9yCmJpbmRhYmxlOiBUcnVlCmFz\
eW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogcmVwbGljYXRpb24KcGxhbnM6\
CiAgLSBuYW1lOiBlcGhlbWVyYWwKICAgIGRlc2NyaXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95cyBh\
biBlcGhlbWVyYWwgR2FsZXJhIGNsdXN0ZXIgb24gTGludXgKICAgIGZyZWU6IFRydWUKICAgIG1l\
dGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBhZG1pbl91c2VyCiAgICAg\
ICAgdGl0bGU6IE9wZW5zaGlmdCBBZG1pbiBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgZGVmYXVsdDogZGV2ZWxvcGVyCiAgICAgICAgI3JlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFt\
ZTogYWRtaW5fcGFzc3dvcmQKICAgICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFBhc3N3b3Jk\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAg\
ICAgIGRlZmF1bHQ6IG5hCiAgICAgIC0gbmFtZTogZ2FsZXJhX3JlcGxpY2FzCiAgICAgICAgdGl0\
bGU6IERhdGFiYXNlIGNvcGllcwogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIGRlZmF1bHQ6\
IDMKICAgICAgLSBuYW1lOiBnYWxlcmFfZGF0YWJhc2UKICAgICAgICB0aXRsZTogR2FsZXJhIERh\
dGFiYXNlIE5hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBnYWxlcmEK\
ICAgICAgLSBuYW1lOiBnYWxlcmFfdXNlcgogICAgICAgIHRpdGxlOiBHYWxlcmEgVXNlcgogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgIC0gbmFtZTogZ2Fs\
ZXJhX3Bhc3N3b3JkCiAgICAgICAgdGl0bGU6IEdhbGVyYSBQYXNzd29yZAogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgLSBuYW1lOiBwZXJzaXN0ZW50CiAgICBk\
ZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRlcGxveXMgYSBwZXJzaXN0ZW50IEdhbGVyYSBjbHVzdGVy\
IG9uIExpbnV4CiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6\
CiAgICAgIC0gbmFtZTogYWRtaW5fdXNlcgogICAgICAgIHRpdGxlOiBPcGVuc2hpZnQgQWRtaW4g\
VXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IGRldmVsb3BlcgogICAg\
ICAgICNyZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGFkbWluX3Bhc3N3b3JkCiAgICAgICAg\
dGl0bGU6IE9wZW5zaGlmdCBBZG1pbiBQYXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICBkZWZhdWx0OiBuYQogICAgICAtIG5h\
bWU6IGdhbGVyYV9yZXBsaWNhcwogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBjb3BpZXMKICAgICAg\
ICB0eXBlOiBudW1iZXIKICAgICAgICBkZWZhdWx0OiAzCiAgICAgIC0gbmFtZTogZ2FsZXJhX2Rh\
dGFiYXNlCiAgICAgICAgdGl0bGU6IEdhbGVyYSBEYXRhYmFzZSBOYW1lCiAgICAgICAgdHlwZTog\
c3RyaW5nCiAgICAgICAgZGVmYXVsdDogZ2FsZXJhCiAgICAgIC0gbmFtZTogZ2FsZXJhX3VzZXIK\
ICAgICAgICB0aXRsZTogR2FsZXJhIFVzZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBk\
ZWZhdWx0OiBhZG1pbgogICAgICAtIG5hbWU6IGdhbGVyYV9wYXNzd29yZAogICAgICAgIHRpdGxl\
OiBHYWxlcmEgUGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBh\
ZG1pbgo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
